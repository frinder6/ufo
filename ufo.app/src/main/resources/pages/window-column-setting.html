<div class="easyui-layout" data-options="fit:true">
    <div data-options="region:'west',split:false,collapsible:false" title="已配置项" style="width:50%;">
        <table id="lgrid"></table>
    </div>

    <div data-options="region:'center',split:false" title="系统表与列项" style="width:50%;">
        <div class="easyui-layout" data-options="fit:true">
            <div data-options="region:'north'" style="height:50px;padding:10px;">
                <select class="easyui-combogrid" style="width:350px;"
                        data-options="
                    panelWidth: 350,
                    idField: 'tableName',
                    textField: 'tableComment',
                    url: 'grid/page.tables',
                    columns: [[{
                        field: 'tableName',
                        title: '表名',
                        width: 100
                    },
                    {
                        field: 'tableComment',
                        title: '描述',
                        width: 150
                    }]],
                    fitColumns: true,
                    label: '选择系统表：',
                    onChange: function(newValue, oldValue){
                        _rchange(newValue);
                    }
                ">
                </select>
            </div>
            <div data-options="region:'center',fit:true">
                <table id="rgrid"></table>
            </div>
        </div>
    </div>
</div>


<script type="text/javascript">
    $lgrid = $('#lgrid');
    $rgrid = $('#rgrid');
    grid($lgrid, {gridName: 'conf-grid-columns-info'}, {gridId: selectRow.id});
    grid($rgrid, {gridName: 'conf-table-columns-info'});

    var _lsave = function () {
        var rows = $lgrid.datagrid('getChanges');
        console.log(rows);
        $.ajax({
            url: 'grid/add.columns',
            type: "POST",
            data: JSON.stringify({
                gridId: selectRow.id,
                entityList: rows
            }),
            success: function (data) {
                layer.msg(data.message);
            },
            dataType: "json",
            contentType: "application/json"
        });
    };

    var _lremove = function () {
        remove($lgrid, {removeUrl: 'grid/remove.columns'});
    };

    var _rimport = function () {
        var rows = $rgrid.datagrid('getSelections');
        // 先添加
        $.each(rows, function (i, row) {
            $lgrid.datagrid('appendRow', row);
        });
        // 后删除
        $.each(rows, function (i, row) {
            $rgrid.datagrid('deleteRow', $rgrid.datagrid('getRowIndex', row));
        });
    };

    /**
     * 下拉grid变化时触发事件
     * @param v
     */
    var _rchange = function (v) {
        $rgrid.datagrid('load', {tableName: v, gridId: parent.selectRow.id});
    };

    //    function f(){open('window-column-setting?gridName=conf-grid-columns-info', {width:900, height:600});}
</script>
