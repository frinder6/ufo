<!DOCTYPE html>
<html>
<head>
    <title>主页面</title>
    <link rel="stylesheet" type="text/css" href="easyui/themes/black/easyui.css">
    <link rel="stylesheet" type="text/css" href="easyui/themes/icon.css">
    <link href="layer/skin/layer.css" rel="stylesheet"/>
    <style>
        html, body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
        }

        .dialog {
            width: 100%;
            max-width: 500px;
            min-height: 200px;
            padding: 10px;
            display: none;
        }

    </style>
</head>
<body>

<div class="easyui-layout" data-options="fit:true">
    <div data-options="region:'center',fit:true">
        <table id="grid"></table>
    </div>
</div>


</body>
<script type="text/javascript" src="js/jquery-3.1.1.js"></script>
<script type="text/javascript" src="easyui/jquery.easyui.min.js"></script>
<script type="text/javascript" src="easyui/locale/easyui-lang-zh_CN.js"></script>
<script type="text/javascript" src="layer/layer.js"></script>
<script type="text/javascript" src="easyui/jquery.easyui.self.js"></script>
<script type="text/javascript" src="easyui/jquery.easyui.self.extend.js"></script>
<script type="text/javascript">
    $grid = $('#grid');
    var gridInfo = JSON.parse('${gridInfo!{}}');
    $.extend(true, params, gridInfo);
    console.log(params);
    // 主页面
    _grid();

    var _conf = function () {
        if (selectRow) {
            var p = {
                title: selectRow.name + '基本信息',
                url: 'grid/grid.form?gridName=grid-extend-info&action=modify',
                padding: 20
            };
            console.log(p);
            open(p, null, _fn);
        } else {
            layer.msg('请选择需要配置的记录！');
        }
    };

    var _fn = function ($dialog) {
        $.getJSON('grid/grid.extend', {gridId: selectRow.id}, function (data) {
            var id;
            if (data) {
                for (var k in data) {
                    data[k] == true ? data[k] = 'true' : '';
                    data[k] == false ? data[k] = 'false' : '';
                }
                id = data.id;
                $('#form').form('load', data);
            }
            $('#form').find('#btnOk').click(function () {
                $('#form').form('submit', {
                    url: 'grid/upsert.grid.extend?id=' + id,
                    onSubmit: function () {
                        return $(this).form('enableValidation').form('validate');
                    },
                    success: function (data) {
                        var r = JSON.parse(data);
                        if (r.status) {
                            layer.msg(r.message);
                        } else {
                            layer.msg('系统去开ufo了，请稍后重试！');
                        }
                    }
                });
            });
        });
        $('#form').find('#btnCancel span.l-btn-text').text('下一步');
        $('#form').find('#btnCancel').click(function () {
            $dialog.dialog('close');
            open({
                title: selectRow.name + '列信息',
                url: 'window-column-setting?gridName=conf-grid-columns-info'
            }, {width: 900, height: 600});
        });
    };
</script>


</html>